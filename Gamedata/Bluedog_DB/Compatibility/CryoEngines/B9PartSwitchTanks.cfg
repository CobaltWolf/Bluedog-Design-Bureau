//
// Thanks Nertea
//

@PART[bluedog*,Bluedog*]:HAS[@RESOURCE[LiquidFuel],@RESOURCE[Oxidizer],!RESOURCE[MonoPropellant],!MODULE[ModuleEngines*],!MODULE[WBIResourceSwitcher]]:NEEDS[B9PartSwitch]:FOR[Bluedog_DB_1]
{
	%tank_volume = #$RESOURCE[LiquidFuel]/maxAmount$
	@tank_volume += #$RESOURCE[Oxidizer]/maxAmount$
	
	%tank_cost = #$RESOURCE[LiquidFuel]/amount$
	@tank_cost *= #$@RESOURCE_DEFINITION[LiquidFuel]/unitCost$
	%ox_cost = #$RESOURCE[Oxidizer]/amount$
	@ox_cost *= #$@RESOURCE_DEFINITION[Oxidizer]/unitCost$
	@tank_cost += #$ox_cost$
	@tank_cost *= -1
	
	%tank_mass = #$tank_volume$
	@tank_mass *= 0.000625
	@tank_mass *= -1
	
	!RESOURCE[LiquidFuel] {}
	!RESOURCE[Oxidizer] {}
	
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = fuelSwitch
		switcherDescription = Fuel
		baseVolume = #$../tank_volume$
		SUBTYPE
		{
			name = LF/O
			tankType = LFOX
			addedMass = #$../../tank_mass$
			addedCost = #$../../tank_cost$
		}
		SUBTYPE
		{
			name = LH2/O
			tankType = LH2OStd
			addedMass = #$../../tank_mass$
			addedCost = #$../../tank_cost$
		}
	}
}

@PART[bluedog*,Bluedog*]:HAS[@RESOURCE[LqdHydrogen],@RESOURCE[Oxidizer],!RESOURCE[MonoPropellant],!MODULE[ModuleEngines*],!MODULE[WBIResourceSwitcher]]:NEEDS[B9PartSwitch]:FOR[Bluedog_DB_1]
{
	%tank_volume = #$RESOURCE[LqdHydrogen]/maxAmount$
	@tank_volume /= 5
	@tank_volume += #$RESOURCE[Oxidizer]/maxAmount$
	
	%tank_cost = #$RESOURCE[LqdHydrogen]/amount$
	@tank_cost *= #$@RESOURCE_DEFINITION[LqdHydrogen]/unitCost$
	%ox_cost = #$RESOURCE[Oxidizer]/amount$
	@ox_cost *= #$@RESOURCE_DEFINITION[Oxidizer]/unitCost$
	@tank_cost += #$ox_cost$
	@tank_cost *= -1
	
	%tank_mass = #$tank_volume$
	@tank_mass *= 0.00025
	@tank_mass *= -1
	
	!RESOURCE[LqdHydrogen] {}
	!RESOURCE[Oxidizer] {}
	
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = fuelSwitch
		switcherDescription = Fuel
		baseVolume = #$../tank_volume$
		SUBTYPE
		{
			name = LH2/O
			tankType = LH2OStd
			addedMass = #$../../tank_mass$
			addedCost = #$../../tank_cost$
		}
		SUBTYPE
		{
			name = LF/O
			tankType = LFOX
			addedMass = #$../../tank_mass$
			addedCost = #$../../tank_cost$
		}
	}
}

@PART[bluedog*,Bluedog*]:HAS[@RESOURCE[LqdHydrogen]]:FOR[Bluedog_DB_8]
{
	MODULE
	{
		name = ModuleBdbBoiloff
		CRYOGENICRESOURCE
		{
			name = LqdHydrogen
			boiloffRate = 8
		}
	}
}

@PART[bluedog*,Bluedog*]:HAS[@MODULE[ModuleB9PartSwitch],!MODULE[ModuleBdbBoiloff]]:FOR[Bluedog_DB_8]
{
	MODULE
	{
		name = ModuleBdbBoiloff
		CRYOGENICRESOURCE
		{
			name = LqdHydrogen
			boiloffRate = 8
		}
	}
}

@PART[bluedog*,Bluedog*]:HAS[@MODULE[WBIResourceSwitcher],!MODULE[ModuleBdbBoiloff]]:FOR[Bluedog_DB_8]
{
	MODULE
	{
		name = ModuleBdbBoiloff
		CRYOGENICRESOURCE
		{
			name = LqdHydrogen
			boiloffRate = 8
		}
	}
}

@PART[bluedog*,Bluedog*]:FOR[Bluedog_DB_9]
{
	!tank_volume = delete
	!tank_cost = delete
	!ox_cost = delete
	!tank_mass = delete
}
